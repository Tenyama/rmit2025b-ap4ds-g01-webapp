{% for p in products %}
<div class="col-12 col-sm-6 col-lg-4">
  <div class="card h-100 product-card">
    <div class="p-3 pb-0">
      <div class="image-frame">
        <div class="ratio ratio-4x3 bg-light-subtle">
          {% set img = p.title|img %}
          {% if img %}
          <img src="{{ img }}" alt="{{ p.title }}" class="w-100 h-100" style="object-fit: cover;">
          {% else %}
          <div class="d-flex h-100 w-100 align-items-center justify-content-center text-muted">
            No Image
          </div>
          {% endif %}
        </div>
      </div>
    </div>
    <div class="card-body">
      <h2 class="h4 title mb-1">
        {% if not q %}{{ p.title }}{% else %}{{ p.title|hl(q) }}{% endif %}
        <span class="text-muted">#{{ p.id }}</span>
      </h2>
      <p class="text-muted mb-1">
        {% if not q %}
          {{ p.description[:100] ~ '...' }}
        {% else %}
          {{ p.description[:100]|hl(q) ~ '...' }}
        {% endif %}
      </p>
    </div>
    <div class="card-footer bg-white border-0 d-flex justify-content-between">
      <div class="tags">
        <div><small class="text-muted">Division</small>: {{ p.division }}</div>
        <div><small class="text-muted">Department</small>: {{ p.department }}</div>
        <div><small class="text-muted">Category</small>: {{ p.class }}</div>
      </div>
      <div class="d-flex flex-column">
        <a href="{{ url_for('catalog.item', id=p.id) }}" class="btn btn-outline-brand ms-auto">
          See details
        </a>
        <p class="mb-0 text-muted text-end">
          {{ p.recommended_count }} recommend
        </p>
      </div>
    </div>
  </div>
</div>
{% endfor %}
